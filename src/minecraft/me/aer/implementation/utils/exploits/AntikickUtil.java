package me.aer.implementation.utils.exploits;

import com.darkmagician6.eventapi.EventManager;
import com.darkmagician6.eventapi.EventTarget;
import me.aer.implementation.utils.Utilities;
import me.aer.injection.events.entity.EventPostEntityUpdate;
import me.aer.injection.events.entity.EventPreEntityUpdate;

public class AntikickUtil implements Utilities {

    private boolean vanilla, vanillaPost;
    private int cycle = 0;

    public AntikickUtil() {
        vanillaPost = false;
        vanilla = false;
        EventManager.register(this);
    }

    public void resetVanilla() {
        vanilla = true;
        vanillaPost = false;
        cycle = 1;
    }


    @EventTarget
    public void preEntityUpdate(EventPreEntityUpdate event) {
        double vanillaMotion = 0.03125D * 1.1;

        if (vanilla && !vanillaPost && cycle == 1) {
            vanillaPost = true;
            minecraft.player.setVelocity(minecraft.player.motionX, -vanillaMotion, minecraft.player.motionZ);
        } else if (cycle >= 2 && cycle <= 5) {
            cycle++;
        } else if (vanilla && !vanillaPost && cycle == 6) {
            vanillaPost = true;
            minecraft.player.setVelocity(minecraft.player.motionX, vanillaMotion, minecraft.player.motionZ);
        }
    }

    @EventTarget
    public void postEntityUpdate(EventPostEntityUpdate event) {
        if (vanilla && vanillaPost && cycle == 1) {
            minecraft.player.motionY = 0;
            vanillaPost = false;
            cycle = 2;
        } else if (vanilla && vanillaPost && cycle == 6) {
            minecraft.player.motionY = 0;
            vanillaPost = false;
            vanilla = false;
        }
    }


}
